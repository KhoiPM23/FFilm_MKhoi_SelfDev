<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${banner.title}">Trang ch·ªß</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
    background: #141414;
    color: #ffffff;
    overflow-x: hidden;
}

/* Header v·ªõi hi·ªáu ·ª©ng trong su·ªët */
.main-header {
    min-height: 70px;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 70px;
    background: linear-gradient(180deg, rgba(0,0,0,0.7) 0%, transparent 100%);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 50px;
    z-index: 1000;
    transition: all 0.3s ease;
} 

.main-header.scrolled {
    background: rgba(20,20,20,0.95);
    backdrop-filter: blur(10px);
}

/* Hero Banner v·ªõi carousel nh·ªè */
.hero-banner {
    padding-top:70px;
    position: relative;
    height: 100vh;
    min-height: 600px;
    overflow: hidden;
    background-size: cover;
    background-position: center;
    transition: background-image 0.5s ease;
}

.hero-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(90deg, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.4) 50%, transparent 100%);
}

.hero-content {
    position: absolute;
    bottom: 20%;
    left: 50px;
    max-width: 600px;
    z-index: 10;
}

.hero-title {
    font-size: 3.5rem;
    font-weight: 800;
    margin-bottom: 20px;
    text-shadow: 2px 2px 8px rgba(0,0,0,0.8);
}

.hero-meta {
    display: flex;
    gap: 20px;
    align-items: center;
    margin-bottom: 20px;
}

.rating {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 5px 12px;
    background: rgba(255,255,255,0.1);
    backdrop-filter: blur(10px);
    border-radius: 6px;
}

.year, .duration {
    padding: 5px 12px;
    background: rgba(255,255,255,0.1);
    backdrop-filter: blur(10px);
    border-radius: 6px;
}

.hero-description {
    font-size: 1.1rem;
    line-height: 1.6;
    margin-bottom: 25px;
    color: rgba(255,255,255,0.9);
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
}

.hero-description.expanded {
    max-height: 150px;
}

.description-toggle {
    background: none;
    border: none;
    color: #e50914;
    cursor: pointer;
    font-size: 1.2rem;
    margin-bottom: 20px;
    transition: transform 0.3s;
}

.description-toggle.expanded {
    transform: rotate(180deg);
}

.hero-actions {
    display: flex;
    gap: 15px;
}

.btn-play {
    padding: 15px 40px;
    background: #e50914;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 1.1rem;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 10px;
    transition: all 0.3s;
}

.btn-play:hover {
    background: #f40612;
    transform: scale(1.05);
}

/* Mini Carousel */
.mini-carousel {
    position: absolute;
    bottom: 50px;
    left: 0;
    right: 0;
    padding: 0 50px;
    z-index: 20;
}

.mini-carousel-track {
    display: flex;
    gap: 15px;
    overflow-x: hidden;
    padding: 10px 0;
    scroll-behavior: smooth;
}

.mini-movie-card {
    flex: 0 0 150px;
    cursor: pointer;
    position: relative;
    transition: all 0.3s;
    border: 2px solid transparent;
}

.mini-movie-card.active {
    border-color: #e50914;
    transform: scale(1.1);
}

.mini-movie-card img {
    width: 100%;
    height: 85px;
    object-fit: cover;
    border-radius: 6px;
}

.mini-movie-info {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 5px;
    background: linear-gradient(0deg, rgba(0,0,0,0.9) 0%, transparent 100%);
    border-radius: 0 0 6px 6px;
}

.mini-movie-title {
    font-size: 0.75rem;
    font-weight: 500;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* Movie Sections */
.movies-section {
    padding: 40px 50px;
    position: relative;
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.section-title {
    font-size: 1.8rem;
    font-weight: 700;
}

/* Movie Cards v·ªõi Hover */
.movie-carousel {
    position: relative;
    overflow: hidden;
}

.movie-slider {
    display: flex;
    gap: 15px;
    transition: transform 0.5s ease;
    padding: 10px 0;
}

.movie-card {
    flex: 0 0 200px;
    cursor: pointer;
    position: relative;
    transition: transform 0.3s;
}

.movie-card:hover {
    transform: scale(1.05);
    z-index: 10;
}

.movie-poster {
    position: relative;
    border-radius: 8px;
    overflow: hidden;
}

.movie-poster img {
    width: 100%;
    height: 300px;
    object-fit: cover;
}

.movie-info {
    padding: 10px 0;
}

.movie-info h3 {
    font-size: 0.95rem;
    font-weight: 500;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* Hover Card Popup */
.movie-hover-card {
    position: absolute;
    top: -20px;
    left: -20px;
    width: 320px;
    background: #181818;
    border-radius: 8px;
    box-shadow: 0 8px 40px rgba(0,0,0,0.8);
    z-index: 100;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s;
    pointer-events: none;
}

.movie-card:hover .movie-hover-card {
    opacity: 1;
    visibility: visible;
    pointer-events: auto;
}

.hover-card-image {
    width: 100%;
    height: 180px;
    object-fit: cover;
    border-radius: 8px 8px 0 0;
}

.hover-card-content {
    padding: 15px;
}

.hover-card-title {
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 10px;
}

.hover-card-meta {
    display: flex;
    gap: 15px;
    margin-bottom: 10px;
    font-size: 0.9rem;
    color: #46d369;
}

.hover-card-genres {
    display: flex;
    gap: 8px;
    margin-bottom: 10px;
    flex-wrap: wrap;
}

.genre-tag {
    padding: 3px 8px;
    background: rgba(255,255,255,0.1);
    border-radius: 4px;
    font-size: 0.75rem;
}

.hover-card-description {
    font-size: 0.85rem;
    color: #d1d1d1;
    line-height: 1.4;
    margin-bottom: 15px;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.hover-card-actions {
    display: flex;
    gap: 10px;
}

.hover-play-btn {
    flex: 1;
    padding: 10px;
    background: #e50914;
    color: white;
    border: none;
    border-radius: 6px;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.hover-add-btn {
    width: 40px;
    height: 40px;
    background: rgba(255,255,255,0.2);
    border: 2px solid rgba(255,255,255,0.5);
    border-radius: 50%;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Carousel Navigation */
.carousel-nav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 50px;
    height: 50px;
    background: rgba(0,0,0,0.7);
    border: none;
    color: white;
    border-radius: 50%;
    cursor: pointer;
    font-size: 1.2rem;
    z-index: 50;
    transition: all 0.3s;
}

.carousel-nav:hover {
    background: rgba(255,255,255,0.2);
}

.carousel-nav.prev {
    left: 10px;
}

.carousel-nav.next {
    right: 10px;
}

/* Footer */
footer {
    padding: 30px 50px;
    background: #0c0c0c;
    text-align: center;
    margin-top: 50px;
    border-top: 1px solid rgba(255,255,255,0.1);
}
</style>
</head>
<body>

<div th:replace="fragments/header :: header"></div>

<!-- Hero Banner with Mini Carousel -->
<section class="hero-banner" id="heroBanner" th:style="'background-image: url(' + ${banner.backdrop} + ')'">
    <div class="hero-overlay"></div>
    
    <div class="hero-content">
        <h1 class="hero-title" th:text="${banner.title}">Movie Title</h1>
        
        <div class="hero-meta">
            <div class="rating">
                <i class="fas fa-star" style="color: #ffd700;"></i>
                <span th:text="${banner.rating}">8.5</span>
            </div>
            <div class="year" th:text="${banner.year}">2025</div>
            <div class="duration">120 ph√∫t</div>
        </div>
        
        <button class="description-toggle" id="descToggle">
            <i class="fas fa-chevron-down"></i>
        </button>
        
        <p class="hero-description" id="heroDesc" th:text="${banner.overview}">
            Movie description here...
        </p>
        
        <div class="hero-actions">
            <button class="btn-play" onclick="location.href='/movie/player/1'">
                <i class="fas fa-play"></i>
                Xem ngay
            </button>
        </div>
    </div>
    
    <!-- Mini Carousel -->
    <div class="mini-carousel">
        <div class="mini-carousel-track" id="miniCarousel">
            <!-- Mini cards will be populated by JS -->
        </div>
    </div>
</section>

<!-- Danh s√°ch phim hot -->
<section class="movies">
    <!-- <div class="section-header">
        <h2>üî• Phim Hot</h2>
        <div class="carousel-nav">
            <button class="nav-btn prev-btn" id="hotPrevBtn">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="nav-btn next-btn" id="hotNextBtn">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>
    
    <div class="movie-carousel">
        <div class="movie-slider" id="hotSlider">
            <div th:each="movie : ${hotMovies}" class="movie-card">
                <div class="movie-poster">
                    <img th:src="${movie.poster}" th:alt="${movie.title}">
                    <div class="movie-overlay">
                        <button class="play-btn">
                            <i class="fas fa-play"></i>
                        </button>
                    </div>
                </div>
                <div class="movie-info">
                    <h3 th:text="${movie.title}">Movie Title</h3>
                    <p class="movie-rating">‚≠ê <span th:text="${movie.rating}">8.5</span></p>
                </div>
            </div>
        </div>
    </div> -->
    <div th:each="movie : ${hotMovies}" class="movie-card">
    <div class="movie-poster">
        <img th:src="${movie.poster}" th:alt="${movie.title}">
    </div>
    <div class="movie-info">
        <h3 th:text="${movie.title}">Movie Title</h3>
    </div>
    
    <!-- Hover Card -->
    <div class="movie-hover-card">
        <img class="hover-card-image" th:src="${movie.poster}" th:alt="${movie.title}">
        <div class="hover-card-content">
            <h3 class="hover-card-title" th:text="${movie.title}">Movie Title</h3>
            <div class="hover-card-meta">
                <span><i class="fas fa-star"></i> <span th:text="${movie.rating}">8.5</span></span>
                <span>2025</span>
                <span>HD</span>
            </div>
            <div class="hover-card-genres">
                <span class="genre-tag">H√†nh ƒë·ªông</span>
                <span class="genre-tag">Phi√™u l∆∞u</span>
            </div>
            <p class="hover-card-description">
                M√¥ t·∫£ ng·∫Øn v·ªÅ phim s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y khi hover...
            </p>
            <div class="hover-card-actions">
                <button class="hover-play-btn" th:onclick="'location.href=\'/movie/detail/' + ${movie.id} + '\''">
                    <i class="fas fa-play"></i>
                    Xem ngay
                </button>
                <button class="hover-add-btn">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
        </div>
    </div>
</div>
</section>

<!-- Phim m·ªõi ra m·∫Øt -->
<section class="movies">    
    <div class="section-header">
        <h2>üÜï Phim M·ªõi Ra M·∫Øt</h2>
        <div class="carousel-nav">
            <button class="nav-btn prev-btn" id="newPrevBtn">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="nav-btn next-btn" id="newNextBtn">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>
    
    <div class="movie-carousel">
        <div class="movie-slider" id="newSlider">
            <div th:each="movie : ${newMovies}" class="movie-card">
                <div class="movie-poster">
                    <img th:src="${movie.poster}" th:alt="${movie.title}">
                    <div class="movie-overlay">
                        <button class="play-btn">
                            <i class="fas fa-play"></i>
                        </button>
                    </div>
                </div>
                <div class="movie-info">
                    <h3 th:text="${movie.title}">Movie Title</h3>
                    <p class="movie-rating">‚≠ê <span th:text="${movie.rating}">8.5</span></p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Anime Hot -->
<section class="movies">
    <div class="section-header">
        <h2>üéå Anime Hot</h2>
        <div class="carousel-nav">
            <button class="nav-btn prev-btn" id="animePrevBtn">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="nav-btn next-btn" id="animeNextBtn">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>
    
    <div class="movie-carousel">
        <div class="movie-slider" id="animeSlider">
            <div th:each="movie : ${animeMovies}" class="movie-card">
                <div class="movie-poster">
                    <img th:src="${movie.poster}" th:alt="${movie.title}">
                    <div class="movie-overlay">
                        <button class="play-btn">
                            <i class="fas fa-play"></i>
                        </button>
                    </div>
                </div>
                <div class="movie-info">
                    <h3 th:text="${movie.title}">Movie Title</h3>
                    <p class="movie-rating">‚≠ê <span th:text="${movie.rating}">8.5</span></p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Phim cho tr·∫ª em -->
<section class="movies">
    <div class="section-header">
        <h2>üë∂ Phim Cho Tr·∫ª Em</h2>
        <div class="carousel-nav">
            <button class="nav-btn prev-btn" id="kidsPrevBtn">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="nav-btn next-btn" id="kidsNextBtn">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>
    
    <div class="movie-carousel">
        <div class="movie-slider" id="kidsSlider">
            <div th:each="movie : ${kidsMovies}" class="movie-card">
                <div class="movie-poster">
                    <img th:src="${movie.poster}" th:alt="${movie.title}">
                    <div class="movie-overlay">
                        <button class="play-btn">
                            <i class="fas fa-play"></i>
                        </button>
                    </div>
                </div>
                <div class="movie-info">
                    <h3 th:text="${movie.title}">Movie Title</h3>
                    <p class="movie-rating">‚≠ê <span th:text="${movie.rating}">8.5</span></p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Phim l·∫ª h√†nh ƒë·ªông -->
<section class="movies">
    <div class="section-header">
        <h2>üí• Phim H√†nh ƒê·ªông Hot</h2>
        <div class="carousel-nav">
            <button class="nav-btn prev-btn" id="actionPrevBtn">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="nav-btn next-btn" id="actionNextBtn">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>
    
    <div class="movie-carousel">
        <div class="movie-slider" id="actionSlider">
            <div th:each="movie : ${actionMovies}" class="movie-card">
                <div class="movie-poster">
                    <img th:src="${movie.poster}" th:alt="${movie.title}">
                    <div class="movie-overlay">
                        <button class="play-btn">
                            <i class="fas fa-play"></i>
                        </button>
                    </div>
                </div>
                <div class="movie-info">
                    <h3 th:text="${movie.title}">Movie Title</h3>
                    <p class="movie-rating">‚≠ê <span th:text="${movie.rating}">8.5</span></p>
                </div>
            </div>
        </div>
    </div>
</section>
<footer>
    <p>¬© 2025 FPTPlay Clone</p>
</footer>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize all carousels
        const carousels = [
            { slider: 'hotSlider', prevBtn: 'hotPrevBtn', nextBtn: 'hotNextBtn' },
            { slider: 'newSlider', prevBtn: 'newPrevBtn', nextBtn: 'newNextBtn' },
            { slider: 'animeSlider', prevBtn: 'animePrevBtn', nextBtn: 'animeNextBtn' },
            { slider: 'kidsSlider', prevBtn: 'kidsPrevBtn', nextBtn: 'kidsNextBtn' },
            { slider: 'actionSlider', prevBtn: 'actionPrevBtn', nextBtn: 'actionNextBtn' },
                     
        ];

        carousels.forEach(carousel => {
            initializeCarousel(carousel.slider, carousel.prevBtn, carousel.nextBtn);
        });
    });

    function initializeCarousel(sliderId, prevBtnId, nextBtnId) {
        const slider = document.getElementById(sliderId);
        const prevBtn = document.getElementById(prevBtnId);
        const nextBtn = document.getElementById(nextBtnId);
        
        if (!slider || !prevBtn || !nextBtn) return;
        
        const cards = slider.querySelectorAll('.movie-card');
        if (cards.length === 0) return;
        
        const cardWidth = 200; // Width of each card + gap
        const containerWidth = slider.parentElement.offsetWidth;
        const visibleCards = Math.floor(containerWidth / cardWidth);
        const maxScroll = Math.max(0, (cards.length - visibleCards) * cardWidth);
        
        let currentScroll = 0;
        
        function updateSlider() {
            slider.style.transform = `translateX(-${currentScroll}px)`;
            
            // Update button states
            prevBtn.disabled = currentScroll <= 0;
            nextBtn.disabled = currentScroll >= maxScroll;
            
            prevBtn.classList.toggle('disabled', currentScroll <= 0);
            nextBtn.classList.toggle('disabled', currentScroll >= maxScroll);
        }
        
        prevBtn.addEventListener('click', function() {
            currentScroll = Math.max(0, currentScroll - cardWidth * 3);
            updateSlider();
        });
        
        nextBtn.addEventListener('click', function() {
            currentScroll = Math.min(maxScroll, currentScroll + cardWidth * 3);
            updateSlider();
        });
        
        // Initialize
        updateSlider();
        
        // Handle window resize for this carousel
        let resizeTimer;
        window.addEventListener('resize', function() {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(function() {
                currentScroll = 0;
                updateSlider();
            }, 250);
        });
    }
</script>
<script>
// Header scroll effect
window.addEventListener('scroll', () => {
    const header = document.querySelector('.main-header');
    const heroHeight = document.querySelector('.hero-banner').offsetHeight;
    
    if (window.scrollY > heroHeight - 100) {
        header.classList.add('scrolled');
    } else {
        header.classList.remove('scrolled');
    }
});

// Description toggle
const descToggle = document.getElementById('descToggle');
const heroDesc = document.getElementById('heroDesc');

descToggle.addEventListener('click', () => {
    heroDesc.classList.toggle('expanded');
    descToggle.classList.toggle('expanded');
});

// Mini Carousel
let miniCarouselData = [];
let currentMovieIndex = 0;

// Fetch popular movies for mini carousel
async function loadMiniCarousel() {
    const API_KEY = 'eac03c4e09a0f5099128e38cb0e67a8f';
    const response = await fetch(`https://api.themoviedb.org/3/movie/popular?api_key=${API_KEY}&language=vi-VN&page=1`);
    const data = await response.json();
    miniCarouselData = data.results.slice(0, 10);
    
    renderMiniCarousel();
}

function renderMiniCarousel() {
    const carousel = document.getElementById('miniCarousel');
    carousel.innerHTML = miniCarouselData.map((movie, index) => `
        <div class="mini-movie-card ${index === 0 ? 'active' : ''}" 
             onclick="selectMovie(${index})"
             data-index="${index}">
            <img src="https://image.tmdb.org/t/p/w500${movie.backdrop_path}" 
                 alt="${movie.title}">
            <div class="mini-movie-info">
                <div class="mini-movie-title">${movie.title}</div>
            </div>
        </div>
    `).join('');
}

function selectMovie(index) {
    currentMovieIndex = index;
    const movie = miniCarouselData[index];
    
    // Update hero banner
    document.getElementById('heroBanner').style.backgroundImage = 
        `url(https://image.tmdb.org/t/p/original${movie.backdrop_path})`;
    document.querySelector('.hero-title').textContent = movie.title;
    document.querySelector('.rating span').textContent = movie.vote_average.toFixed(1);
    document.querySelector('.year').textContent = new Date(movie.release_date).getFullYear();
    document.getElementById('heroDesc').textContent = movie.overview;
    
    // Update active card
    document.querySelectorAll('.mini-movie-card').forEach(card => {
        card.classList.remove('active');
    });
    document.querySelector(`.mini-movie-card[data-index="${index}"]`).classList.add('active');
    
    // Auto scroll to center
    centerActiveCard();
}

function centerActiveCard() {
    const carousel = document.getElementById('miniCarousel');
    const activeCard = carousel.querySelector('.active');
    if (activeCard) {
        const cardLeft = activeCard.offsetLeft;
        const cardWidth = activeCard.offsetWidth;
        const carouselWidth = carousel.offsetWidth;
        const scrollLeft = cardLeft - (carouselWidth / 2) + (cardWidth / 2);
        
        carousel.scrollTo({
            left: scrollLeft,
            behavior: 'smooth'
        });
    }
}

// Auto rotate movies
setInterval(() => {
    currentMovieIndex = (currentMovieIndex + 1) % miniCarouselData.length;
    selectMovie(currentMovieIndex);
}, 8000);

// Load on page ready
document.addEventListener('DOMContentLoaded', loadMiniCarousel);

// Enhanced hover cards positioning
document.querySelectorAll('.movie-card').forEach(card => {
    card.addEventListener('mouseenter', function(e) {
        const hoverCard = this.querySelector('.movie-hover-card');
        const rect = this.getBoundingClientRect();
        
        // Adjust position if near edge
        if (rect.right > window.innerWidth - 320) {
            hoverCard.style.left = 'auto';
            hoverCard.style.right = '0';
        }
    });
});
</script>
</body>
</html>